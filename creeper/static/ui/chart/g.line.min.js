/*
 * g.Raphael 0.5 - Charting library, based on RaphaÃ«l
 *
 * Copyright (c) 2009 Dmitry Baranovskiy (http://g.raphaeljs.com)
 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
 */
(function(){function A(I,H){var K=I.length/H,J=0,F=K,G=0,E=[];while(J<I.length){F--;if(F<0){G+=I[J]*(1+F);E.push(G/K);G=I[J++]*-F;F+=K}else{G+=I[J++]}}return E}function D(F,G,K,L,H,I){var E=(K-F)/2,M=(H-K)/2,S=Math.atan((K-F)/Math.abs(L-G)),Q=Math.atan((H-K)/Math.abs(L-I));S=G<L?Math.PI-S:S;Q=I<L?Math.PI-Q:Q;var N=Math.PI/2-((S+Q)%(Math.PI*2))/2,O=E*Math.sin(N+S),J=E*Math.cos(N+S),P=M*Math.sin(N+Q),R=M*Math.cos(N+Q);return{x1:K-O,y1:L+J,x2:K+P,y2:L+R}}function C(Q,p,q,M,O,J,I,b){var e=this;b=b||{};if(!Q.raphael.is(J[0],"array")){J=[J]}if(!Q.raphael.is(I[0],"array")){I=[I]}var n=b.gutter||10,W=Math.max(J[0].length,I[0].length),H=b.symbol||"",Z=b.colors||e.colors,Aa=null,F=null,N=Q.set(),k=[];for(var S=0,s=I.length;S<s;S++){W=Math.max(W,I[S].length)}var Ae=Q.set();for(S=0,s=I.length;S<s;S++){if(b.shade){Ae.push(Q.path().attr({stroke:"none",fill:Z[S],opacity:b.nostroke?1:0.3}))}if(I[S].length>M-2*n){I[S]=A(I[S],M-2*n);W=M-2*n}if(J[S]&&J[S].length>M-2*n){J[S]=A(J[S],M-2*n)}}var r=Array.prototype.concat.apply([],J),E=Array.prototype.concat.apply([],I),Ag=e.snapEnds(Math.min.apply(Math,r),Math.max.apply(Math,r),J[0].length-1),Ac=Ag.from,f=Ag.to,l=e.snapEnds(Math.min.apply(Math,E),Math.max.apply(Math,E),I[0].length-1),P=l.from,m=l.to,h=(M-n*2)/((f-Ac)||1),c=(O-n*2)/((m-P)||1);var g=Q.set();if(b.axis){var w=(b.axis+"").split(/[,\s]+/);+w[0]&&g.push(e.axis(p+n,q+n,M-2*n,Ac,f,b.axisxstep||Math.floor((M-2*n)/20),2,Q));+w[1]&&g.push(e.axis(p+M-n,q+O-n,O-2*n,P,m,b.axisystep||Math.floor((O-2*n)/20),3,Q));+w[2]&&g.push(e.axis(p+n,q+O-n,M-2*n,Ac,f,b.axisxstep||Math.floor((M-2*n)/20),0,Q));+w[3]&&g.push(e.axis(p+n,q+O-n,O-2*n,P,m,b.axisystep||Math.floor((O-2*n)/20),1,Q))}var o=Q.set(),R=Q.set(),z;for(S=0,s=I.length;S<s;S++){if(!b.nostroke){o.push(z=Q.path().attr({stroke:Z[S],"stroke-width":b.width||2,"stroke-linejoin":"round","stroke-linecap":"round","stroke-dasharray":b.dash||""}))}var Ab=Raphael.is(H,"array")?H[S]:H,v=Q.set();k=[];for(var Ad=0,d=I[S].length;Ad<d;Ad++){var U=p+n+((J[S]||J[0])[Ad]-Ac)*h,V=q+O-n-(I[S][Ad]-P)*c;(Raphael.is(Ab,"array")?Ab[Ad]:Ab)&&v.push(Q[Raphael.is(Ab,"array")?Ab[Ad]:Ab](U,V,(b.width||2)*3).attr({fill:Z[S],stroke:"none"}));if(b.smooth){if(Ad&&Ad!=d-1){var K=p+n+((J[S]||J[0])[Ad-1]-Ac)*h,L=q+O-n-(I[S][Ad-1]-P)*c,G=p+n+((J[S]||J[0])[Ad+1]-Ac)*h,t=q+O-n-(I[S][Ad+1]-P)*c,Af=D(K,L,U,V,G,t);k=k.concat([Af.x1,Af.y1,U,V,Af.x2,Af.y2])}if(!Ad){k=["M",U,V,"C",U,V]}}else{k=k.concat([Ad?"L":"M",U,V])}}if(b.smooth){k=k.concat([U,V,U,V])}R.push(v);if(b.shade){Ae[S].attr({path:k.concat(["L",U,q+O-n,"L",p+n+((J[S]||J[0])[0]-Ac)*h,q+O-n,"z"]).join(",")})}!b.nostroke&&z.attr({path:k.join(",")})}function u(Aq){var An=[];for(var Ak=0,Ah=J.length;Ak<Ah;Ak++){An=An.concat(J[Ak])}An.sort();var Aj=[],Y=[];for(Ak=0,Ah=An.length;Ak<Ah;Ak++){An[Ak]!=An[Ak-1]&&Aj.push(An[Ak])&&Y.push(p+n+(An[Ak]-Ac)*h)}An=Aj;Ah=An.length;var x=Aq||Q.set();for(Ak=0;Ak<Ah;Ak++){var Ai=Y[Ak]-(Y[Ak]-(Y[Ak-1]||p))/2,y=((Y[Ak+1]||p+M)-Y[Ak])/2+(Y[Ak]-(Y[Ak-1]||p))/2,Am;Aq?(Am={}):x.push(Am=Q.rect(Ai-1,q,Math.max(y+1,1),O).attr({stroke:"none",fill:"#000",opacity:0}));Am.values=[];Am.symbols=Q.set();Am.y=[];Am.x=Y[Ak];Am.axis=An[Ak];for(var Ao=0,Ap=I.length;Ao<Ap;Ao++){Aj=J[Ao]||J[0];for(var Al=0,a=Aj.length;Al<a;Al++){if(Aj[Al]==An[Ak]){Am.values.push(I[Ao][Al]);Am.y.push(q+O-n-(I[Ao][Al]-P)*c);Am.symbols.push(N.symbols[Ao][Al])}}}Aq&&Aq.call(Am)}!Aq&&(Aa=x)}function T(An){var x=An||Q.set(),Ak;for(var Al=0,y=I.length;Al<y;Al++){for(var Ah=0,Am=I[Al].length;Ah<Am;Ah++){var Aj=p+n+((J[Al]||J[0])[Ah]-Ac)*h,a=p+n+((J[Al]||J[0])[Ah?Ah-1:1]-Ac)*h,Ai=q+O-n-(I[Al][Ah]-P)*c;An?(Ak={}):x.push(Ak=Q.circle(Aj,Ai,Math.abs(a-Aj)/2).attr({stroke:"none",fill:"#000",opacity:0}));Ak.x=Aj;Ak.y=Ai;Ak.value=I[Al][Ah];Ak.line=N.lines[Al];Ak.shade=N.shades[Al];Ak.symbol=N.symbols[Al][Ah];Ak.symbols=N.symbols[Al];Ak.axis=(J[Al]||J[0])[Ah];An&&An.call(Ak)}}!An&&(F=x)}N.push(o,Ae,R,g,Aa,F);N.lines=o;N.shades=Ae;N.symbols=R;N.axis=g;N.hoverColumn=function(X,Y){!Aa&&u();Aa.mouseover(X).mouseout(Y);return this};N.clickColumn=function(X){!Aa&&u();Aa.click(X);return this};N.hrefColumn=function(Y){var a=Q.raphael.is(arguments[0],"array")?arguments[0]:arguments;if(!(arguments.length-1)&&typeof Y=="object"){for(var j in Y){for(var X=0,y=Aa.length;X<y;X++){if(Aa[X].axis==j){Aa[X].attr("href",Y[j])}}}}!Aa&&u();for(X=0,y=a.length;X<y;X++){Aa[X]&&Aa[X].attr("href",a[X])}return this};N.hover=function(X,Y){!F&&T();F.mouseover(X).mouseout(Y);return this};N.click=function(X){!F&&T();F.click(X);return this};N.each=function(X){T(X);return this};N.eachColumn=function(X){u(X);return this};return N}var B=function(){};B.prototype=Raphael.g;C.prototype=new B;Raphael.fn.linechart=function(I,J,K,E,F,H,G){return new C(this,I,J,K,E,F,H,G)}})();