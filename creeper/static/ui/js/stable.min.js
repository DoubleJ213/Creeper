(function(A){A.fn.jTable=function(B){return this.each(function(){var R=A(this),E=R.attr("nowrapTD");var U=R.width()||A("#container").width()-2;if(U<=100){U=A("#container").width()-2}if(U>1600){U=1158}var O=[];var Q=R.parent().addClass("j-resizeGrid");var I=A(this).attr("layoutH");var K=R.find("thead>tr:last-child").find("th");for(var G=0,W=K.size();G<W;G++){var L=A(K[G]);var N=[],P=L.innerWidth()-(100*L.innerWidth()/U)-2;if(P>100&&G!=K.size()-1){P=100}else{if(P<40&&G==K.size()-1){P=50}}if(L[0].id=="volume_actionId"){P=L[0].style.width}N[0]=parseInt(P);N[1]=L.attr("align");O[O.length]=N}A(this).wrap("<div class='grid'></div>");var V=R.parent().html(R.html());var F=V.find("thead");F.wrap("<div class='gridHeader'><div class='gridThead'><table style='width:"+(U-20)+"px;'></table></div></div>");var X=A(">tr:last-child",F);var T=A(">th",X);A("th",F).each(function(){var Y=A(this);Y.html("<div class='gridCol' title='"+Y.text().trim()+"'>"+Y.html()+"</div>")});T.each(function(Z){var Y=A(this),a=O[Z];Y.addClass(a[1]).hoverClass("hover").removeAttr("align").removeAttr("width").width(a[0])}).filter("[orderField]").orderBy({targetType:R.attr("targetType"),rel:R.attr("rel"),asc:R.attr("asc")||"asc",desc:R.attr("desc")||"desc"});var J=V.find(">tbody");var M=I?" layoutH='"+I+"'":"";J.wrap("<div class='gridScroller'"+M+" style='width:"+(Q.width()||A("#container").width()-2)+"px;'><div class='gridTbody'><table style='width:"+(U-20)+"px;'></table></div></div>");var C=A(">tr:first-child",J);var H=J.find(">tr");H.hoverClass().each(function(){var Y=A(this);var b=A(">td",this);for(var Z=0;Z<b.size();Z++){var a=A(b[Z]);if(E!="false"){a.html("<div>"+a.html()+"</div>")}if(Z<O.length){a.addClass(O[Z][1])}}Y.click(function(){H.filter(".selected").removeClass("selected");Y.addClass("selected");var c=Y.attr("target");if(c){if(A("#"+c,V).size()==0){V.prepend('<input id="'+c+'" type="hidden" />')}A("#"+c,V).val(Y.attr("rel"))}})});A(">td",C).each(function(Y){if(Y<O.length){A(this).width(O[Y][0])}});V.append("<div class='resizeMarker' style='height:300px; left:57px;display:none;'></div><div class='resizeProxy' style='height:300px; left:377px;display:none;'></div>");var D=A(".gridScroller",V);D.scroll(function(Z){var Y=A(".gridThead",V);if(D.scrollLeft()>0){Y.css("position","relative");var a=D.scrollLeft();Y.css("left",D.cssv("left")-a)}if(D.scrollLeft()==0){Y.css("position","relative");Y.css("left","0px")}return false});A(">tr",F).each(function(){A(">th",this).each(function(Z){var a=this,Y=A(this);Y.mouseover(function(c){var b=A.jTableTool.getOffset(a,c).offsetX;if(Y.outerWidth()-b<5){Y.css("cursor","col-resize").mousedown(function(d){A(".resizeProxy",V).show().css({left:A.jTableTool.getRight(a)-A(".gridScroller",V).scrollLeft(),top:A.jTableTool.getTop(a),height:A.jTableTool.getHeight(a,V),cursor:"col-resize"});A(".resizeMarker",V).show().css({left:A.jTableTool.getLeft(a)+1-A(".gridScroller",V).scrollLeft(),top:A.jTableTool.getTop(a),height:A.jTableTool.getHeight(a,V)});A(".resizeProxy",V).jDrag(A.extend(B,{scop:true,cellMinW:20,relObj:A(".resizeMarker",V)[0],move:"horizontal",event:d,stop:function(){var f=A(".resizeProxy",V).position().left;var m=A(".resizeMarker",V).position().left;var l=f-m-Y.outerWidth()-9;var i=A.jTableTool.getColspan(Y);var g=A.jTableTool.getCellNum(Y);var j=Y.width(),k=Y.width()+l;var h=A(">td",C).eq(g-1);Y.width(k+"px");h.width(k+"px");var n=A(F).parent();n.width((n.width()-j+k)+"px");var e=A(J).parent();e.width((e.width()-j+k)+"px");A(".resizeMarker,.resizeProxy",V).hide()}}))})}else{Y.css("cursor",Y.attr("orderField")?"pointer":"default");Y.unbind("mousedown")}return false})})});function S(){A("div.j-resizeGrid").each(function(){var Y=A(this).innerWidth();if(Y){A("div.gridScroller",this).width(Y+"px")}})}A(window).unbind(DWZ.eventType.resizeGrid).bind("resizeGrid",S)})};A.jTableTool={getLeft:function(B){var C=0;A(B).prevAll().each(function(){C+=A(this).outerWidth()});return C-1},getRight:function(B){var C=0;A(B).prevAll().andSelf().each(function(){C+=A(this).outerWidth()});return C-1},getTop:function(C){var B=0;A(C).parent().prevAll().each(function(){B+=A(this).outerHeight()});return B},getHeight:function(C,E){var B=0;var D=A(C).parent();D.nextAll().andSelf().each(function(){B+=A(this).outerHeight()});A(".gridTbody",E).children().each(function(){B+=A(this).outerHeight()});return B},getCellNum:function(B){return A(B).prevAll().andSelf().size()},getColspan:function(B){return A(B).attr("colspan")||1},getStart:function(B){var C=1;A(B).prevAll().each(function(){C+=parseInt(A(this).attr("colspan")||1)});return C},getPageCoord:function(C){var B={x:0,y:0};while(C){B.x+=C.offsetLeft;B.y+=C.offsetTop;C=C.offsetParent}return B},getOffset:function(G,D){if(A.browser.msie){var B=A(G).offset();var F={offsetX:D.pageX||D.screenX,offsetY:D.pageY||D.screenY};var C={offsetX:F.offsetX-B.left,offsetY:F.offsetY-B.top};return C}var E=D.target;if(E.offsetLeft==undefined){E=E.parentNode}var H=A.jTableTool.getPageCoord(E);var I={x:window.pageXOffset+D.clientX,y:window.pageYOffset+D.clientY};var C={offsetX:I.x-H.x,offsetY:I.y-H.y};return C}}})(jQuery);