function validateCallback(C,A,D){var B=$(C);if(!B.valid()){return false}var E=function(){$.ajax({type:C.method||"POST",url:B.attr("action"),data:B.serializeArray(),dataType:"json",cache:false,async:true,success:A||DWZ.ajaxDone,error:DWZ.ajaxError})};if(D){alertMsg.confirm(D,{okCall:E})}else{E()}return false}function validateCallback2(C,A,D){if($("#progressBar")){$("#progressBar").css("display","block")}if($("#background")){$("#background").css("display","block")}var B=$(C);if(!B.valid()){return false}var E=function(){$.ajax({type:C.method||"POST",url:B.attr("action"),data:B.serializeArray(),dataType:"json",cache:false,success:A||DWZ.ajaxDone2,error:DWZ.ajaxError2})};if(D){alertMsg.confirm(D,{okCall:E})}else{E()}return false}function iframeCallback(D,A){var B=$(D),C=$("#callbackframe");if(!B.valid()){return false}if(C.size()==0){C=$("<iframe id='callbackframe' name='callbackframe' src='about:blank' style='display:none'></iframe>").appendTo("body")}if(!D.ajax){B.append('<input type="hidden" name="ajax" value="1" />')}D.target="callbackframe";_iframeResponse(C[0],A||DWZ.ajaxDone)}function _iframeResponse(B,A){var C=$(B),D=$(document);D.trigger("ajaxStart");C.bind("load",function(F){C.unbind("load");D.trigger("ajaxStop");if(B.src=="javascript:'%3Chtml%3E%3C/html%3E';"||B.src=="javascript:'<html></html>';"){return}var H=B.contentDocument||B.document;if(H.readyState&&H.readyState!="complete"){return}if(H.body&&H.body.innerHTML=="false"){return}var G;if(H.XMLDocument){G=H.XMLDocument}else{if(H.body){try{G=C.contents().find("body").text();G=jQuery.parseJSON(G)}catch(E){G=H.body.innerHTML}}else{G=H}}A(G)})}function navTabAjaxDone(A){DWZ.ajaxDone(A);if(A.statusCode==DWZ.statusCode.ok){if(A.navTabId){navTab.reloadFlag(A.navTabId)}else{var B=$("#pagerForm",navTab.getCurrentPanel());var C=B.size()>0?B.serializeArray():{};navTabPageBreak(C,A.rel)}if("closeCurrent"==A.callbackType){setTimeout(function(){navTab.closeCurrentTab(A.navTabId)},100)}else{if("forward"==A.callbackType){navTab.reload(A.forwardUrl)}else{if("forwardConfirm"==A.callbackType){alertMsg.confirm(A.confirmMsg||DWZ.msg("forwardConfirmMsg"),{okCall:function(){navTab.reload(A.forwardUrl)}})}else{navTab.getCurrentPanel().find(":input[initValue]").each(function(){var D=$(this).attr("initValue");$(this).val(D)})}}}}}function dialogAjaxDone(A){DWZ.ajaxDone(A);if(A.statusCode==DWZ.statusCode.ok){if(A.navTabId){navTab.reload(A.forwardUrl,{navTabId:A.navTabId})}else{if(A.rel){var B=$("#pagerForm",navTab.getCurrentPanel());var C=B.size()>0?B.serializeArray():{};navTabPageBreak(C,A.rel)}}if("closeCurrent"==A.callbackType){$.pdialog.closeCurrent()}}}function navTabSearch(B,A){var C=$(B);if(B[DWZ.pageInfo.pageNum]){B[DWZ.pageInfo.pageNum].value=1}navTab.reload(C.attr("action"),{data:C.serializeArray(),navTabId:A});return false}function dialogSearch(B){var A=$(B);if(B[DWZ.pageInfo.pageNum]){B[DWZ.pageInfo.pageNum].value=1}$.pdialog.reload(A.attr("action"),{data:A.serializeArray()});return false}function dwzSearch(A,B){if(B=="dialog"){dialogSearch(A)}else{navTabSearch(A)}return false}function divSearch(B,C){var A=$(B);if(B[DWZ.pageInfo.pageNum]){B[DWZ.pageInfo.pageNum].value=1}if(C){var D=$("#"+C);D.ajaxUrl({type:"POST",url:A.attr("action"),data:A.serializeArray(),callback:function(){D.find("[layoutH]").layoutH()}})}return false}function _getPagerForm(A,C){var B=$("#pagerForm",A).get(0);if(B){if(C["pageNum"]){B[DWZ.pageInfo.pageNum].value=C["pageNum"]}if(C["numPerPage"]){B[DWZ.pageInfo.numPerPage].value=C["numPerPage"]}if(C["orderField"]){B[DWZ.pageInfo.orderField].value=C["orderField"]}if(C["orderDirection"]&&B[DWZ.pageInfo.orderDirection]){B[DWZ.pageInfo.orderDirection].value=C["orderDirection"]}}return B}function dwzPageBreak(D){var C=$.extend({targetType:"navTab",rel:"",data:{pageNum:"",numPerPage:"",orderField:"",orderDirection:""},callback:null},D);var A=C.targetType=="dialog"?$.pdialog.getCurrent():navTab.getCurrentPanel();if(C.rel){var F=A.find("#"+C.rel);var B=_getPagerForm(F,C.data);if(B){if(C.targetType=="div"){F=$("#"+C.rel);var E=new Array();F.children(" form ").eq(1).find(" .grid > .gridHeader > .gridThead > table > thead > tr > th").each(function(){E.push($(this).width())});F.ajaxUrl({type:"GET",url:$(B).attr("action"),data:$(B).serializeArray(),callback:function(){F.children(" form ").eq(1).find(" .grid > .gridHeader > .gridThead > table > thead > tr > th").each(function(H){$(this).width(E[H])});F.children(" form ").eq(1).find(" .grid > .gridScroller > .gridTbody > table > tbody > tr:eq(0) > td ").each(function(H){$(this).width(E[H])});F.find("[layoutH]").layoutH()}})}else{F.ajaxUrl({type:"POST",url:$(B).attr("action"),data:$(B).serializeArray(),callback:function(){F.find("[layoutH]").layoutH()}})}}}else{var B=_getPagerForm(A,C.data);var G=$(B).serializeArray();if(C.targetType=="dialog"){if(B){$.pdialog.reload($(B).attr("action"),{data:G,callback:C.callback})}}else{if(B){navTab.reload($(B).attr("action"),{data:G,callback:C.callback})}}}}function navTabPageBreak(B,A){dwzPageBreak({targetType:"navTab",rel:A,data:B})}function divPageBreak(B,A){dwzPageBreak({targetType:"div",rel:A,data:B})}function dialogPageBreak(B,A){dwzPageBreak({targetType:"dialog",rel:A,data:B})}function ajaxTodo(url,callback){var $callback=callback||navTabAjaxDone;if(!$.isFunction($callback)){$callback=eval("("+callback+")")}$.ajax({type:"POST",url:url,dataType:"json",cache:false,success:$callback,error:DWZ.ajaxError})}function uploadifyAllComplete(A,C){if(C.errors){var B="The total number of files uploaded: "+C.filesUploaded+"\nThe total number of errors while uploading: "+C.errors+"\nThe total number of bytes uploaded: "+C.allBytesLoaded+"\nThe average speed of all uploaded files: "+C.speed;alert("event:"+A+"\n"+B)}}function uploadifyComplete(B,A,D,C,E){DWZ.ajaxDone(DWZ.jsonEval(C))}function uploadifyError(C,B,D,A){alert("event:"+C+"\nqueueId:"+B+"\nfileObj.name:"+D.name+"\nerrorObj.type:"+A.type+"\nerrorObj.info:"+A.info)}$.fn.extend({ajaxTodo:function(){return this.each(function(){var A=$(this);A.click(function(C){var B=unescape(A.attr("href")).replaceTmById($(C.target).parents(".unitBox:first"));DWZ.debug(B);if(!B.isFinishedTm()){alertMsg.error(A.attr("warn")||DWZ.msg("alertSelectMsg"));return false}var D=A.attr("title");if(D){alertMsg.confirm(D,{okCall:function(){ajaxTodo(B,A.attr("callback"))}})}else{ajaxTodo(B,A.attr("callback"))}C.preventDefault()})})},dwzExport:function(){function A(E){var B=E.attr("targetType")=="dialog"?$.pdialog.getCurrent():navTab.getCurrentPanel();var C=$("#pagerForm",B);var D=E.attr("href");window.location=D+(D.indexOf("?")==-1?"?":"&")+C.serialize()}return this.each(function(){var B=$(this);B.click(function(C){var D=B.attr("title");if(D){alertMsg.confirm(D,{okCall:function(){A(B)}})}else{A(B)}C.preventDefault()})})}});