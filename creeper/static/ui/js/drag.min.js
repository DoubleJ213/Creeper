(function(A){A.fn.jDrag=function(B){if(typeof B=="string"){if(B=="destroy"){return this.each(function(){A(this).unbind("mousedown",A.rwdrag.start);A.data(this,"pp-rwdrag",null)})}}return this.each(function(){var C=A(this);A.data(A.rwdrag,"pp-rwdrag",{options:A.extend({el:C,obj:C},B)});if(B.event){A.rwdrag.start(B.event)}else{var D=B.selector;A(D,obj).bind("mousedown",A.rwdrag.start)}})};A.rwdrag={start:function(C){var D=A.data(this,"pp-rwdrag");var B=D.options.el[0];A.data(B,"pp-rwdrag",{options:D.options});if(!A.rwdrag.current){A.rwdrag.current={el:B,oleft:parseInt(B.style.left)||0,otop:parseInt(B.style.top)||0,ox:C.pageX||C.screenX,oy:C.pageY||C.screenY};A(document).bind("mouseup",A.rwdrag.stop);A(document).bind("mousemove",A.rwdrag.drag)}},drag:function(B){if(!B){var B=window.event}var E=A.rwdrag.current;var G=A.data(E.el,"pp-rwdrag");var C=(E.oleft+(B.pageX||B.clientX)-E.ox);var D=(E.otop+(B.pageY||B.clientY)-E.oy);if(D<1){D=0}if(G.options.move=="horizontal"){if((G.options.minW&&C>=A(G.options.obj).cssv("left")+G.options.minW)&&(G.options.maxW&&C<=A(G.options.obj).cssv("left")+G.options.maxW)){E.el.style.left=C+"px"}else{if(G.options.scop){if(G.options.relObj){if((C-parseInt(G.options.relObj.style.left))>G.options.cellMinW){E.el.style.left=C+"px"}}else{E.el.style.left=C+"px"}}}}else{if(G.options.move=="vertical"){E.el.style.top=D+"px"}else{var F=G.options.selector?A(G.options.selector,G.options.obj):A(G.options.obj);if(C>=-F.outerWidth()*2/3&&D>=0&&(C+F.outerWidth()/3<A(window).width())&&(D+F.outerHeight()<A(window).height())){E.el.style.left=C+"px";E.el.style.top=D+"px"}}}if(G.options.drag){G.options.drag.apply(E.el,[E.el])}return A.rwdrag.preventEvent(B)},stop:function(B){var C=A.rwdrag.current;var D=A.data(C.el,"pp-rwdrag");A(document).unbind("mousemove",A.rwdrag.drag);A(document).unbind("mouseup",A.rwdrag.stop);if(D.options.stop){D.options.stop.apply(C.el,[C.el])}A.rwdrag.current=null;return A.rwdrag.preventEvent(B)},preventEvent:function(B){if(B.stopPropagation){B.stopPropagation()}if(B.preventDefault){B.preventDefault()}return false}}})(jQuery);