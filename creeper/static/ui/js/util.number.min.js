(function(){function C(G){G=G.toString().replace(/\$|\,/g,"");if(isNaN(G)){G="0"}var F=(G==(G=Math.abs(G)));G=Math.floor(G*100+0.50000000001);var D=G%100;G=Math.floor(G/100).toString();if(D<10){D="0"+D}for(var E=0;E<Math.floor((G.length-(1+E))/3);E++){G=G.substring(0,G.length-(4*E+3))+","+G.substring(G.length-(4*E+3))}return(((F)?"":"-")+G+"."+D)}function B(D){if(!D){return 0}D=D.replace(",","");return $.isNumeric(D)?parseFloat(D):0}function A(S,I){S=S.toString().replace(/,/g,"");S=S.replace(/^0+/,"");if(S==""){return"零元整"}else{if(isNaN(S)){return"错误：金额不是合法的数值！"}}var X="";var G="";if(S.length>1){if(S.indexOf("-")==0){S=S.replace("-","");X="负"}if(S.indexOf("+")==0){S=S.replace("+","")}}var U="",O="";var F;var V;var J,D,M,L;var P;var H,E,K;var Q,T;var R=(typeof(I)=="undefined"||I==null||Number(I)<0||Number(I)>5);V=S.split(".");if(V.length>1){U=V[0];O=V[1];if(R){I=O.length>5?5:O.length}var W=Number("0."+O);W*=Math.pow(10,I);W=Math.round(Math.abs(W));W/=Math.pow(10,I);var N=W.toString().split(".");if(Number(N[0])==1){U=(Number(U)+1).toString()}if(N.length>1){O=N[1]}else{O=""}}else{U=S;O="";if(R){I=0}}if(U.length>44){return"错误：金额值太大了！整数位长【"+U.length.toString()+"】超过了上限——44位/千正/10^43（注：1正=1万涧=1亿亿亿亿亿，10^40）！"}J=new Array("零","壹","贰","叁","肆","伍","陆","柒","捌","玖");D=new Array("","拾","佰","仟");M=new Array("","万","亿","兆","京","垓","杼","穰","沟","涧","正");L=new Array("角","分","厘","毫","丝");F="";if(Number(U)>0){P=0;for(H=0;H<U.length;H++){E=U.length-H-1;K=U.substr(H,1);Q=E/4;T=E%4;if(K=="0"){P++}else{if(P>0){F+=J[0]}P=0;F+=J[Number(K)]+D[T]}if(T==0&&P<4){F+=M[Q]}}F+="元"}for(H=0;H<O.length;H++){K=O.substr(H,1);if(K!="0"){F+=J[Number(K)]+L[H]}}if(F==""){F="零元"}if(O==""){F+="整"}F=G+X+F;return F}Number.prototype.formatCurrency=function(D){return C(this)};Number.prototype.amountInWords=function(D){return A(this,D)};String.prototype.parseCurrency=function(D){return B(this)};String.prototype.amountInWords=function(D){var E=B(this);return A(E,D)}})();