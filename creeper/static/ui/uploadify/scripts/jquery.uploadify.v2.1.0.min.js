if(jQuery){(function(A){jQuery.extend(jQuery.fn,{uploadify:function(B){A(this).each(function(){settings=A.extend({id:A(this).attr("id"),uploader:"uploadify.swf",script:"uploadify.php",expressInstall:null,folder:"",height:30,width:110,cancelImg:"cancel.png",wmode:"opaque",scriptAccess:"sameDomain",fileDataName:"Filedata",method:"POST",queueSizeLimit:999,simUploadLimit:1,queueID:false,displayData:"percentage",onInit:function(){},onSelect:function(){},onQueueFull:function(){},onCheck:function(){},onCancel:function(){},onError:function(){},onProgress:function(){},onComplete:function(){},onAllComplete:function(){}},B);var G=location.pathname;G=G.split("/");G.pop();G=G.join("/")+"/";var C={};C.uploadifyID=settings.id;C.pagepath=G;if(settings.buttonImg){C.buttonImg=escape(settings.buttonImg)}if(settings.buttonText){C.buttonText=escape(settings.buttonText)}if(settings.rollover){C.rollover=true}C.script=settings.script;C.folder=escape(settings.folder);if(settings.scriptData){var F="";for(var E in settings.scriptData){F+="&"+E+"="+settings.scriptData[E]}C.scriptData=escape(F.substr(1))}C.width=settings.width;C.height=settings.height;C.wmode=settings.wmode;C.method=settings.method;C.queueSizeLimit=settings.queueSizeLimit;C.simUploadLimit=settings.simUploadLimit;if(settings.hideButton){C.hideButton=true}if(settings.fileDesc){C.fileDesc=settings.fileDesc}if(settings.fileExt){C.fileExt=settings.fileExt}if(settings.multi){C.multi=true}if(settings.auto){C.auto=true}if(settings.sizeLimit){C.sizeLimit=settings.sizeLimit}if(settings.checkScript){C.checkScript=settings.checkScript}if(settings.fileDataName){C.fileDataName=settings.fileDataName}if(settings.queueID){C.queueID=settings.queueID}if(settings.onInit()!==false){A(this).css("display","none");A(this).after('<div id="'+A(this).attr("id")+'Uploader"></div>');swfobject.embedSWF(settings.uploader,settings.id+"Uploader",settings.width,settings.height,"9.0.24",settings.expressInstall,C,{"quality":"high","wmode":settings.wmode,"allowScriptAccess":settings.scriptAccess});if(settings.queueID==false){A("#"+A(this).attr("id")+"Uploader").after('<div id="'+A(this).attr("id")+'Queue" class="uploadifyQueue"></div>')}}if(typeof(settings.onOpen)=="function"){A(this).bind("uploadifyOpen",settings.onOpen)}A(this).bind("uploadifySelect",{"action":settings.onSelect,"queueID":settings.queueID},function(L,I,M){if(L.data.action(L,I,M)!==false){var H=Math.round(M.size/1024*100)*0.01;var J="KB";if(H>1000){H=Math.round(H*0.001*100)*0.01;J="MB"}var K=H.toString().split(".");if(K.length>1){H=K[0]+"."+K[1].substr(0,2)}else{H=K[0]}if(M.name.length>20){fileName=M.name.substr(0,20)+"..."}else{fileName=M.name}queue="#"+A(this).attr("id")+"Queue";if(L.data.queueID){queue="#"+L.data.queueID}A(queue).append('<div id="'+A(this).attr("id")+I+'" class="uploadifyQueueItem">								<div class="cancel">									<a href="javascript:jQuery(\'#'+jQuery(this).attr("id")+"').uploadifyCancel('"+I+'\')"><img src="'+settings.cancelImg+'" border="0" /></a>								</div>								<span class="fileName">'+fileName+" ("+H+J+')</span><span class="percentage"></span>								<div class="uploadifyProgress">									<div id="'+jQuery(this).attr("id")+I+'ProgressBar" class="uploadifyProgressBar"><!--Progress Bar--></div>								</div>							</div>')}});if(typeof(settings.onSelectOnce)=="function"){A(this).bind("uploadifySelectOnce",settings.onSelectOnce)}A(this).bind("uploadifyQueueFull",{"action":settings.onQueueFull},function(H,I){if(H.data.action(H,I)!==false){alert("The queue is full.  The max size is "+I+".")}});A(this).bind("uploadifyCheckExist",{"action":settings.onCheck},function(L,M,H,N,O){var K=new Object();K=H;K.folder=G+N;if(O){for(var J in H){var I=J}}A.post(M,K,function(R){for(var P in R){if(L.data.action(L,M,H,N,O)!==false){var Q=confirm("Do you want to replace the file "+R[P]+"?");if(!Q){document.getElementById(A(L.target).attr("id")+"Uploader").cancelFileUpload(P,true,true)}}}if(O){document.getElementById(A(L.target).attr("id")+"Uploader").startFileUpload(I,true)}else{document.getElementById(A(L.target).attr("id")+"Uploader").startFileUpload(null,true)}},"json")});A(this).bind("uploadifyCancel",{"action":settings.onCancel},function(J,I,L,M,H){if(J.data.action(J,I,L,M,H)!==false){var K=(H==true)?0:250;A("#"+A(this).attr("id")+I).fadeOut(K,function(){A(this).remove()})}});if(typeof(settings.onClearQueue)=="function"){A(this).bind("uploadifyClearQueue",settings.onClearQueue)}var D=[];A(this).bind("uploadifyError",{"action":settings.onError},function(J,I,L,H){if(J.data.action(J,I,L,H)!==false){var K=new Array(I,L,H);D.push(K);A("#"+A(this).attr("id")+I+" .percentage").text(" - "+H.type+" Error");A("#"+A(this).attr("id")+I).addClass("uploadifyError")}});A(this).bind("uploadifyProgress",{"action":settings.onProgress,"toDisplay":settings.displayData},function(I,H,J,K){if(I.data.action(I,H,J,K)!==false){A("#"+A(this).attr("id")+H+"ProgressBar").css("width",K.percentage+"%");if(I.data.toDisplay=="percentage"){displayData=" - "+K.percentage+"%"}if(I.data.toDisplay=="speed"){displayData=" - "+K.speed+"KB/s"}if(I.data.toDisplay==null){displayData=" "}A("#"+A(this).attr("id")+H+" .percentage").text(displayData)}});A(this).bind("uploadifyComplete",{"action":settings.onComplete},function(I,H,K,J,L){if(I.data.action(I,H,K,unescape(J),L)!==false){A("#"+A(this).attr("id")+H+" .percentage").text(" - Completed");A("#"+A(this).attr("id")+H).fadeOut(250,function(){A(this).remove()})}});if(typeof(settings.onAllComplete)=="function"){A(this).bind("uploadifyAllComplete",{"action":settings.onAllComplete},function(I,H){if(I.data.action(I,H)!==false){D=[]}})}})},uploadifySettings:function(B,F,C){var G=false;A(this).each(function(){if(B=="scriptData"&&F!=null){if(C){var J=F}else{var J=A.extend(settings.scriptData,F)}var L="";for(var K in J){L+="&"+K+"="+escape(J[K])}F=L.substr(1)}G=document.getElementById(A(this).attr("id")+"Uploader").updateSettings(B,F)});if(F==null){if(B=="scriptData"){var I=unescape(G).split("&");var H=new Object();for(var E=0;E<I.length;E++){var D=I[E].split("=");H[D[0]]=D[1]}G=H}return G}},uploadifyUpload:function(B){A(this).each(function(){document.getElementById(A(this).attr("id")+"Uploader").startFileUpload(B,false)})},uploadifyCancel:function(B){A(this).each(function(){document.getElementById(A(this).attr("id")+"Uploader").cancelFileUpload(B,true,false)})},uploadifyClearQueue:function(){A(this).each(function(){document.getElementById(A(this).attr("id")+"Uploader").clearFileUploadQueue(false)})}})})(jQuery)};